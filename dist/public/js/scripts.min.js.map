{"version":3,"sources":["src/public/js/scripts.js"],"names":["$","on","self","this","target","data","val","length","addClass","next","after","class","text","removeClass","remove","form","alert_modal","wrapper_el","title_el","find","title","body_el","ajax","url","type","serialize","dataType","beforeSend","blockUI","message","css","backgroundColor","color","border","success","console","log","each","errors","key","html","unblockUI","onUnblock","modal","reset","window","location","href","redirect_to","error","xhr","ajaxOptions","thrownError","jQuery","noConflict"],"mappings":"CAAA,SAAAA,GAKAA,EAAA,mBAAAC,GAAA,SAAA,WACA,IAAAC,EAAAF,EAAAG,MACAC,EAAAJ,EAAAA,EAAAG,MAAAE,KAAA,aAEAH,EAAAI,MAAAC,QAAAL,EAAAI,OAAAF,EAAAE,OACAJ,EAAAM,SAAA,aACAN,EAAAO,KAAA,0CAAAF,QACAL,EAAAQ,MAAAV,EAAA,UAAA,CACAW,MAAA,0CACAC,KAAAV,EAAAG,KAAA,+BAIAH,EAAAW,YAAA,aACAX,EAAAO,KAAA,oBAAAK,YAOAd,EAAA,sBAAAC,GAAA,SAAA,WACA,IAAAc,EAAAf,EAAAG,MACAa,EAAA,CACAC,WAAAjB,EAAA,gBACAkB,SAAAlB,EAAA,gBAAAmB,KAAA,gBACAC,MAAA,GACAC,QAAArB,EAAA,gBAAAmB,KAAA,gBA8EA,OA5EAnB,EAAAsB,KAAA,CACAC,IAAAvB,EAAAG,MAAAE,KAAA,UACAmB,KAAA,OACAnB,KAAAU,EAAAU,YACAC,SAAA,OACAC,WAAA,WACA3B,EAAA4B,QAAA,CACAC,QAAA,yBACAC,IAAA,CACAC,gBAAA,cACAC,MAAA,OACAC,OAAA,WAIAC,QAAA,SAAA7B,GACA8B,QAAAC,IAAA/B,GACA,WAAAA,GACAW,EAAAI,MAAA,OACAL,EAAAI,KAAA,uCAAAkB,KAAA,WACArC,EAAAG,MAAAU,YAAA,aACAb,EAAAG,MAAAM,KAAA,QAAA4B,KAAA,WACArC,EAAAG,MAAAW,aAGAd,EAAAqC,KAAAhC,EAAAiC,OAAA,SAAAC,EAAAV,GACA7B,EAAA,IAAAuC,GAAA/B,SAAA,aAAAE,MAAAV,EAAA,UAAA,CACAW,MAAA,oBACAC,KAAA,KAAAiB,OAGAb,EAAAE,SAAAsB,KAAAxB,EAAAI,OACAJ,EAAAK,QAAAmB,KAAAnC,EAAAwB,SACA7B,EAAAyC,UAAA,CACAC,UAAA,WACA1B,EAAAC,WAAA0B,MAAA,aAIA3B,EAAAI,MAAA,QACAL,EAAA,GAAA6B,QACA7B,EAAAI,KAAA,uCAAAkB,KAAA,WACArC,EAAAG,MAAAU,YAAA,aACAb,EAAAG,MAAAM,KAAA,QAAA4B,KAAA,WACArC,EAAAG,MAAAW,kBAIA,IAAAC,EAAAV,KAAA,2BAAA,IAAAU,EAAAV,KAAA,yBACAW,EAAAE,SAAAsB,KAAAxB,EAAAI,OACAJ,EAAAK,QAAAmB,KAAAnC,EAAAwB,SACA7B,EAAAyC,UAAA,CACAC,UAAA,WACA1B,EAAAC,WAAA0B,MAAA,iBAGA,IAAA5B,EAAAV,KAAA,yBACAL,EAAAyC,UAAA,CACAC,UAAA,WACAG,OAAAC,SAAAC,KAAA1C,EAAA2C,iBAMAC,MAAA,SAAAC,EAAAC,EAAAC,GACApD,EAAAyC,YACAzB,EAAAE,SAAAN,KAAA,QACAI,EAAAK,QAAAmB,KAAA,+EACAxC,EAAAyC,UAAA,CACAC,UAAA,WACA1B,EAAAC,WAAA0B,MAAA,eAKA,IA9GA,CAiHAU,OAAAC","file":"scripts.min.js","sourcesContent":["(function($) {\r\n\r\n    /**\r\n     * Verificação de igualdade.\r\n     */\r\n    $('[data-equal-to]').on('change', function() {\r\n        var self = $(this),\r\n            target = $($(this).data('equal-to'));\r\n\r\n        if(self.val().length && self.val() != target.val()) {\r\n            self.addClass('not-valid');\r\n            if(!self.next('span.error-alert.error-alert-not-equal').length) {\r\n                self.after($('<span/>', {\r\n                    \"class\": \"error-alert small error-alert-not-equal\",\r\n                    \"text\": self.data('equal-to-error-message')\r\n                }));\r\n            }\r\n        } else {\r\n            self.removeClass('not-valid');\r\n            self.next('span.error-alert').remove();\r\n        }\r\n    });\r\n\r\n    /**\r\n     * Submissão genérica de formulários.\r\n     */\r\n    $('[data-ajax-submit]').on('submit', function(){\r\n        var form = $(this);\r\n        var alert_modal = {\r\n            wrapper_el: $('.alert-modal'),\r\n            title_el: $('.alert-modal').find('.modal-title'),\r\n            title: '',\r\n            body_el: $('.alert-modal').find('.modal-body')\r\n        };\r\n        $.ajax({\r\n            url: $(this).data('action'),\r\n            type: 'post',\r\n            data: form.serialize(),\r\n            dataType: 'json',\r\n            beforeSend: function() {\r\n                $.blockUI({\r\n                    message: 'Aguarde um instante...',\r\n                    css: {\r\n                        backgroundColor: 'transparent',\r\n                        color: '#fff',\r\n                        border: 'none'\r\n                    }\r\n                });\r\n            },\r\n            success: function(data) {\r\n                console.log(data);\r\n                if('errors' in data) { // existem erros?\r\n                    alert_modal.title = 'Erro';\r\n                    form.find('.not-valid, input, select, textarea').each(function() {\r\n                        $(this).removeClass('not-valid');\r\n                        $(this).next('span').each(function() {\r\n                            $(this).remove();\r\n                        });\r\n                    });\r\n                    $.each(data.errors, function(key, message) {\r\n                        $('#' + key).addClass('not-valid').after($('<span/>', {\r\n                            \"class\": \"error-alert small\",\r\n                            \"text\": \"- \" + message\r\n                        }));\r\n                    });\r\n                    alert_modal.title_el.html(alert_modal.title);\r\n                    alert_modal.body_el.html(data.message);\r\n                    $.unblockUI({\r\n                        onUnblock: function() {\r\n                            alert_modal.wrapper_el.modal('show');\r\n                        }\r\n                    });\r\n                } else { // sucesso\r\n                    alert_modal.title = 'Aviso';\r\n                    form[0].reset();\r\n                    form.find('.not-valid, input, select, textarea').each(function() {\r\n                        $(this).removeClass('not-valid');\r\n                        $(this).next('span').each(function() {\r\n                            $(this).remove();\r\n                        });\r\n                    });\r\n                    // exibir alerta OU redirecionar\r\n                    if(typeof form.data('ajax-submit-alert') !== 'undefined' && typeof form.data('ajax-submit-redirect') === 'undefined') {\r\n                        alert_modal.title_el.html(alert_modal.title);\r\n                        alert_modal.body_el.html(data.message);\r\n                        $.unblockUI({\r\n                            onUnblock: function() {\r\n                                alert_modal.wrapper_el.modal('show');\r\n                            }\r\n                        });\r\n                    } else if(typeof form.data('ajax-submit-redirect') !== 'undefined') {\r\n                        $.unblockUI({\r\n                            onUnblock: function() {\r\n                                window.location.href = data.redirect_to;\r\n                            }\r\n                        });   \r\n                    }\r\n                }\r\n            },\r\n            error: function (xhr, ajaxOptions, thrownError) {\r\n                $.unblockUI();\r\n                alert_modal.title_el.text('Erro');\r\n                alert_modal.body_el.html('Falha ao realizar a solicitação.<br/>Por favor, tente novamente mais tarde.');\r\n                $.unblockUI({\r\n                    onUnblock: function() {\r\n                        alert_modal.wrapper_el.modal('show');\r\n                    }\r\n                });\r\n            }\r\n        });\r\n        return false;\r\n    });\r\n\r\n})(jQuery.noConflict());\r\n\r\n"]}